THEANO_FLAGS = device=gpu,floatX=float32
Using device: auto (on machine n4)
Theano version: 0.9.0.dev-RELEASE
Training options:
-----------------------------------
                alpha_init : 0.5
                alpha_rate : 0.001
                    clip_c : 1.0
                   decay_c : 0
                 device_id : auto
    discriminator_loop_num : 1
        generator_loop_num : 1
                      init : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/attention-e512-r1024-adadelta_1e+00-bs80-bleu-each5000_do_d0.0-gc1-init_xavier-s1234.1-val001-bleu_38.850.npz
                   initdis : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/models/discriminator_en_fr/cnn_discriminator-e512-adadelta_1e+00-bs80-bleu-each50-gc1-init_xavier-s1234.1-val002-loss_0.218.npz
                    initlm : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/rnnlm-e512-i512-o512-r1024-adadelta_1e+00-bs80-bleu-each5000_do_d0.0-gc1-init_xavier-s1234.3-val002-loss_6.638.npz
                   max_acc : 0.85
                max_epochs : 1000000
             max_iteration : 1000000
                    maxlen : 50
                   min_acc : 0.75
  model_discriminator_type : cnn_discriminator
 model_language_model_type : rnnlm
                model_type : attention_GAN
        monte_carlo_search : True
                  patience : 1000
                   rollnum : 20
               sample_freq : 0
               save_best_n : 4
                      seed : 1234
             snapshot_freq : 0
                valid_beam : 12
                valid_freq : 100
              valid_metric : bleu
               valid_njobs : 16
            valid_save_hyp : False
               valid_start : 1

Model options:
-----------------------------------
                batch_size : 80
                  dec_type : gru_cond
                   dropout : 0.0
             embedding_dim : 512
                  enc_type : gru
                in_emb_dim : 512
                layer_norm : False
                     lrate : 1
                   n_words : 30000
               n_words_src : 30000
               n_words_trg : 30000
                     njobs : 15
                 norm_cost : False
                 optimizer : adadelta
               out_emb_dim : 512
                   rnn_dim : 1024
                 save_path : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/models/nmt_GAN_en_fr_LM/attention_GAN-e512-i512-o512-r1024-adadelta_1e+00-bs80-bleu-each100_do_d0.0-gc1-init_xavier-s1234.7
              shuffle_mode : None
              tied_trg_emb : True
              valid_metric : bleu
               weight_init : xavier
                     dicts =
                       src : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/train.en.vocab.pkl
                    src_lm : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/train.fr.vocab.pkl
                       trg : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/train.fr.vocab.pkl
                      data =
                 train_src : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/train.en
                 train_trg : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/train.fr
                 valid_src : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/valid.en
                 valid_trg : /users/limsi_nmt/ngoho/Stage/GAN_NMT_model/data/valid.fr

Initializing parameters
Creating shared variables
Will override parameters from pre-trained weights init Generator
  attention-e512-r1024-adadelta_1e+00-bs80-bleu-each5000_do_d0.0-gc1-init_xavier-s1234.1-val001-bleu_38.850.npz
Will override parameters from pre-trained weights init Discriminator
  cnn_discriminator-e512-adadelta_1e+00-bs80-bleu-each50-gc1-init_xavier-s1234.1-val002-loss_0.218.npz
Will override parameters from pre-trained weights init Language Model
  rnnlm-e512-i512-o512-r1024-adadelta_1e+00-bs80-bleu-each5000_do_d0.0-gc1-init_xavier-s1234.3-val002-loss_6.638.npz
Number of parameters generator    : 42.4M
Number of parameters discriminator: 8.7M
Number of parameters language model: 14.8M
Loading data
Shuffle mode: None
Source vocabulary size: 7751
Target vocabulary size: 9067
19972 training samples
506 validation samples
dropout (emb,ctx,out): 0.00, 0.00, 0.00
Building model
Input tensor order: 
[x, x_mask, y, y_mask]
Building sampler
Building optimizer adadelta (initial lr=1.00000)
Starting Epoch 1
----------------
Loss Generator:   1.327416
Discriminator: Epoch:      1, update:       1, cost:   0.391305
Loss Generator:   1.198823
Discriminator: Epoch:      1, update:       2, cost:   0.378205
Loss Generator:   1.104484
Discriminator: Epoch:      1, update:       3, cost:   0.445388
Loss Generator:   1.150080
Discriminator: Epoch:      1, update:       4, cost:   0.311999
Loss Generator:   0.985992
Discriminator: Epoch:      1, update:       5, cost:   0.424031
Loss Generator:   1.159316
Discriminator: Epoch:      1, update:       6, cost:   0.374278
Loss Generator:   1.175810
Discriminator: Epoch:      1, update:       7, cost:   0.342666
Loss Generator:   1.029896
Discriminator: Epoch:      1, update:       8, cost:   0.381473
Loss Generator:   1.377990
Discriminator: Epoch:      1, update:       9, cost:   0.343954
Loss Generator:   1.410330
Discriminator: Epoch:      1, update:      10, cost:   0.373108
Generator    : Epoch:      1, update:      10, cost:   1.410330
Loss Generator:   1.347887
Discriminator: Epoch:      1, update:      11, cost:   0.288323
Loss Generator:   1.319808
Loss Generator:   1.427382
Discriminator: Epoch:      1, update:      13, cost:   0.342620
Loss Generator:   1.309369
Loss Generator:   1.137027
Discriminator: Epoch:      1, update:      15, cost:   0.270252
Loss Generator:   0.891799
Discriminator: Epoch:      1, update:      16, cost:   0.261048
Loss Generator:   1.322453
Loss Generator:   1.200357
Loss Generator:   1.262757
Loss Generator:   1.299582
Discriminator: Epoch:      1, update:      20, cost:   0.281751
Generator    : Epoch:      1, update:      20, cost:   1.299582
Loss Generator:   1.135487
Loss Generator:   1.137343
Discriminator: Epoch:      1, update:      22, cost:   0.311037
Loss Generator:   1.034236
Loss Generator:   1.439549
Loss Generator:   1.318948
Loss Generator:   1.164560
Loss Generator:   1.044533
Loss Generator:   1.168583
Loss Generator:   1.187116
Loss Generator:   1.195472
Generator    : Epoch:      1, update:      30, cost:   1.195472
Loss Generator:   1.003422
Loss Generator:   1.017873
Discriminator: Epoch:      1, update:      32, cost:   0.314569
Loss Generator:   1.473010
Discriminator: Epoch:      1, update:      33, cost:   0.343630
Loss Generator:   1.463560
Discriminator: Epoch:      1, update:      34, cost:   0.328676
Loss Generator:   1.241922
Discriminator: Epoch:      1, update:      35, cost:   0.287442
Loss Generator:   1.192583
Loss Generator:   1.024593
Loss Generator:   1.251941
Discriminator: Epoch:      1, update:      38, cost:   0.313096
Loss Generator:   1.215931
Discriminator: Epoch:      1, update:      39, cost:   0.343223
Loss Generator:   1.470033
Generator    : Epoch:      1, update:      40, cost:   1.470033
Loss Generator:   1.182483
Discriminator: Epoch:      1, update:      41, cost:   0.297695
Loss Generator:   1.216923
Discriminator: Epoch:      1, update:      42, cost:   0.272661
Loss Generator:   1.217063
Loss Generator:   1.207101
Discriminator: Epoch:      1, update:      44, cost:   0.308156
Loss Generator:   1.401036
Loss Generator:   1.443023
Discriminator: Epoch:      1, update:      46, cost:   0.311988
Loss Generator:   1.157076
Discriminator: Epoch:      1, update:      47, cost:   0.337969
Loss Generator:   1.292425
Discriminator: Epoch:      1, update:      48, cost:   0.275832
Loss Generator:   1.511097
Loss Generator:   1.222155
Generator    : Epoch:      1, update:      50, cost:   1.222155
Loss Generator:   1.353240
Loss Generator:   1.569329
Loss Generator:   1.141111
Discriminator: Epoch:      1, update:      53, cost:   0.337211
Loss Generator:   1.382323
Discriminator: Epoch:      1, update:      54, cost:   0.367235
Loss Generator:   1.339484
Discriminator: Epoch:      1, update:      55, cost:   0.310557
Loss Generator:   1.121571
Loss Generator:   1.142005
Discriminator: Epoch:      1, update:      57, cost:   0.332101
Loss Generator:   1.250550
Discriminator: Epoch:      1, update:      58, cost:   0.320342
Loss Generator:   1.176045
Discriminator: Epoch:      1, update:      59, cost:   0.327172
Loss Generator:   1.362971
Generator    : Epoch:      1, update:      60, cost:   1.362971
Loss Generator:   1.220723
Discriminator: Epoch:      1, update:      61, cost:   0.349792
Loss Generator:   1.554463
Discriminator: Epoch:      1, update:      62, cost:   0.362086
Loss Generator:   1.188683
Discriminator: Epoch:      1, update:      63, cost:   0.276726
Loss Generator:   1.161177
Discriminator: Epoch:      1, update:      64, cost:   0.383520
Loss Generator:   1.287333
Discriminator: Epoch:      1, update:      65, cost:   0.320224
Loss Generator:   1.223706
Loss Generator:   1.060496
Discriminator: Epoch:      1, update:      67, cost:   0.268253
Loss Generator:   1.264419
Loss Generator:   1.264234
Loss Generator:   1.367645
Generator    : Epoch:      1, update:      70, cost:   1.367645
Loss Generator:   1.071342
Loss Generator:   1.087531
Loss Generator:   1.331349
Discriminator: Epoch:      1, update:      73, cost:   0.306075
Loss Generator:   1.368312
Loss Generator:   1.129901
Loss Generator:   1.167300
Loss Generator:   1.192153
Loss Generator:   1.305650
Loss Generator:   0.975607
Loss Generator:   0.938953
Discriminator: Epoch:      1, update:      80, cost:   0.322664
Generator    : Epoch:      1, update:      80, cost:   0.938953
Loss Generator:   1.111216
Loss Generator:   1.104863
Loss Generator:   1.002452
Loss Generator:   0.878020
Loss Generator:   0.886910
Loss Generator:   0.911198
Loss Generator:   1.105423
Discriminator: Epoch:      1, update:      87, cost:   0.308158
Loss Generator:   1.204338
Loss Generator:   1.088612
Loss Generator:   1.254968
Discriminator: Epoch:      1, update:      90, cost:   0.410659
Generator    : Epoch:      1, update:      90, cost:   1.254968
Loss Generator:   1.114300
Discriminator: Epoch:      1, update:      91, cost:   0.326487
Loss Generator:   1.426579
Discriminator: Epoch:      1, update:      92, cost:   0.292235
Loss Generator:   1.041166
Discriminator: Epoch:      1, update:      93, cost:   0.286353
Loss Generator:   1.000621
Loss Generator:   1.166988
Discriminator: Epoch:      1, update:      95, cost:   0.271772
Loss Generator:   1.258123
Discriminator: Epoch:      1, update:      96, cost:   0.220386
Loss Generator:   1.035509
Loss Generator:   0.994943
Discriminator: Epoch:      1, update:      98, cost:   0.285314
Loss Generator:   1.192470
Discriminator: Epoch:      1, update:      99, cost:   0.281715
Loss Generator:   1.261240
Discriminator: Epoch:      1, update:     100, cost:   0.332918
Generator    : Epoch:      1, update:     100, cost:   1.261240
Validation  1 - LOSS = 1.686 (PPL: 5.395)
Calling beam-search process
Beam-search ended, took 2.58197 minutes.
Validation  1 - BLEU = 7.26, 14.2/8.8/5.8/3.8 (BP=1.000, ratio=4.099, hyp_len=17299, ref_len=4220)
Saving model with best validation BLEU
--> Current BEST BLEU = 7.260 at validation 1
--> Current BEST LOSS = 1.686 (PPL: 5.395) at validation 1
--> This is model: attention_GAN-e512-i512-o512-r1024-adadelta_1e+00-bs80-bleu-each100_do_d0.0-gc1-init_xavier-s1234.7
Loss Generator:   1.263118
Loss Generator:   1.254217
Loss Generator:   1.050064
Loss Generator:   1.070563
Loss Generator:   0.953377
Loss Generator:   1.343213
Loss Generator:   1.111271
Loss Generator:   1.041113
Loss Generator:   1.190344
Loss Generator:   1.073686
Generator    : Epoch:      1, update:     110, cost:   1.073686
Loss Generator:   1.364016
Loss Generator:   1.171127
Loss Generator:   1.102338
Loss Generator:   1.037983
Loss Generator:   1.269529
Loss Generator:   1.389533
Discriminator: Epoch:      1, update:     116, cost:   0.332675
Loss Generator:   0.969132
Discriminator: Epoch:      1, update:     117, cost:   0.293170
Loss Generator:   1.315704
Discriminator: Epoch:      1, update:     118, cost:   0.288773
Loss Generator:   1.141246
Discriminator: Epoch:      1, update:     119, cost:   0.177055
Loss Generator:   1.084524
Generator    : Epoch:      1, update:     120, cost:   1.084524
Loss Generator:   1.265343
Loss Generator:   1.218965
Loss Generator:   1.213234
Loss Generator:   1.297474
Loss Generator:   1.342694
Loss Generator:   1.208300
Loss Generator:   1.250797
Loss Generator:   1.361516
Loss Generator:   1.186626
Loss Generator:   1.295477
Generator    : Epoch:      1, update:     130, cost:   1.295477
Loss Generator:   1.023288
Loss Generator:   1.087281
Loss Generator:   1.039093
Loss Generator:   1.349137
Loss Generator:   1.265319
Loss Generator:   1.014772
Loss Generator:   1.168262
Loss Generator:   0.985089
Loss Generator:   1.250901
Loss Generator:   1.227422
Generator    : Epoch:      1, update:     140, cost:   1.227422
Loss Generator:   1.058863
Loss Generator:   1.210822
Loss Generator:   1.411541
Loss Generator:   1.307981
Loss Generator:   1.361579
Loss Generator:   1.524977
Loss Generator:   1.124138
Loss Generator:   1.057162
Loss Generator:   1.058549
Loss Generator:   1.101366
Generator    : Epoch:      1, update:     150, cost:   1.101366
Loss Generator:   1.249590
Loss Generator:   1.229446
Discriminator: Epoch:      1, update:     152, cost:   0.417339
Loss Generator:   1.232480
Loss Generator:   1.184383
Discriminator: Epoch:      1, update:     154, cost:   0.335544
Loss Generator:   1.301495
Discriminator: Epoch:      1, update:     155, cost:   0.307317
Loss Generator:   1.096731
Discriminator: Epoch:      1, update:     156, cost:   0.263793
Loss Generator:   1.091861
Discriminator: Epoch:      1, update:     157, cost:   0.298201
Loss Generator:   1.139978
Discriminator: Epoch:      1, update:     158, cost:   0.333353
Loss Generator:   0.939295
Loss Generator:   1.042207
Discriminator: Epoch:      1, update:     160, cost:   0.487986
Generator    : Epoch:      1, update:     160, cost:   1.042207
Loss Generator:   1.123271
Discriminator: Epoch:      1, update:     161, cost:   0.582612
Loss Generator:   1.409485
Loss Generator:   1.320953
Loss Generator:   1.381370
Discriminator: Epoch:      1, update:     164, cost:   0.335392
Loss Generator:   1.362865
Discriminator: Epoch:      1, update:     165, cost:   0.340628
Loss Generator:   1.583717
Loss Generator:   1.370029
Discriminator: Epoch:      1, update:     167, cost:   0.337736
Loss Generator:   1.268296
Loss Generator:   1.260092
Loss Generator:   1.315825
Generator    : Epoch:      1, update:     170, cost:   1.315825
Loss Generator:   1.049557
Loss Generator:   1.069088
Loss Generator:   1.227259
Loss Generator:   1.037302
Loss Generator:   1.091560
Loss Generator:   1.162276
Loss Generator:   1.493470
Loss Generator:   1.606215
Loss Generator:   1.375445
Loss Generator:   1.179541
Generator    : Epoch:      1, update:     180, cost:   1.179541
Loss Generator:   1.225984
Loss Generator:   1.311952
Loss Generator:   1.314950
Loss Generator:   1.562885
Loss Generator:   1.369322
Loss Generator:   1.179307
Loss Generator:   1.194135
Loss Generator:   1.332677
Loss Generator:   1.397664
Loss Generator:   1.311532
Generator    : Epoch:      1, update:     190, cost:   1.311532
Loss Generator:   1.431696
Loss Generator:   1.247589
Loss Generator:   1.578311
Loss Generator:   1.599023
Loss Generator:   1.017947
Loss Generator:   1.390182
Loss Generator:   1.311406
Loss Generator:   1.281648
Loss Generator:   1.335146
Loss Generator:   1.238310
Generator    : Epoch:      1, update:     200, cost:   1.238310
Validation  2 - LOSS = 1.675 (PPL: 5.339)
Calling beam-search process
Beam-search ended, took 3.04451 minutes.
Validation  2 - BLEU = 3.86, 7.8/4.7/3.1/2.0 (BP=1.000, ratio=6.641, hyp_len=28023, ref_len=4220)
Early stopping patience: 999 validation left
--> Current BEST BLEU = 7.260 at validation 1
--> Current BEST LOSS = 1.675 (PPL: 5.339) at validation 2
--> This is model: attention_GAN-e512-i512-o512-r1024-adadelta_1e+00-bs80-bleu-each100_do_d0.0-gc1-init_xavier-s1234.7
Loss Generator:   1.138485
Loss Generator:   1.104853
Loss Generator:   1.236870
Loss Generator:   1.187859
Loss Generator:   1.044345
Loss Generator:   1.161354
Loss Generator:   1.403924
Loss Generator:   1.311225
Loss Generator:   1.276224
Discriminator: Epoch:      1, update:     209, cost:   0.317643
Loss Generator:   1.202114
Generator    : Epoch:      1, update:     210, cost:   1.202114
Loss Generator:   1.244971
Discriminator: Epoch:      1, update:     211, cost:   0.357323
Loss Generator:   1.452464
Loss Generator:   1.361207
Loss Generator:   1.100891
Loss Generator:   1.360230
Loss Generator:   1.382879
Loss Generator:   1.223932
Loss Generator:   1.211684
Loss Generator:   1.015332
Loss Generator:   1.137439
Generator    : Epoch:      1, update:     220, cost:   1.137439
Loss Generator:   1.232005
Loss Generator:   1.113442
Loss Generator:   1.209077
Loss Generator:   1.114078
Loss Generator:   1.135437
Loss Generator:   1.081682
Loss Generator:   1.201605
Loss Generator:   1.083564
Loss Generator:   1.136471
Loss Generator:   1.199152
Generator    : Epoch:      1, update:     230, cost:   1.199152
Loss Generator:   1.355736
Loss Generator:   1.311103
Loss Generator:   1.288921
Loss Generator:   0.973381
Loss Generator:   1.059085
Loss Generator:   1.123263
Loss Generator:   1.108832
Loss Generator:   1.206524
Loss Generator:   1.205036
Loss Generator:   1.204624
Generator    : Epoch:      1, update:     240, cost:   1.204624
Loss Generator:   1.214072
Loss Generator:   1.120096
Loss Generator:   1.029351
Loss Generator:   1.193695
Loss Generator:   1.196839
Loss Generator:   1.216087
Loss Generator:   1.031980
Loss Generator:   1.031306
Loss Generator:   1.190381
Loss Generator:   1.012068
Generator    : Epoch:      1, update:     250, cost:   1.012068
---------------------------------------------------------
Epoch summary of Generator    :
--> Epoch 1 finished with mean loss 1.21175 (PPL: 3.35935)
--> Epoch took 13665.621 minutes, 3279.749 sec/update
Epoch summary of Discriminator:
--> Epoch 1 finished with mean loss 0.32845 (PPL: 1.38881)
--> Epoch took 13665.621 minutes, 3279.749 sec/update
---------------------------------------------------------
Starting Epoch 2
----------------
Loss Generator:   1.438494
Loss Generator:   1.340298
Loss Generator:   1.237944
Loss Generator:   1.296232
Discriminator: Epoch:      2, update:     254, cost:   0.253633
Loss Generator:   1.171195
Loss Generator:   1.184496
Loss Generator:   1.263781
Loss Generator:   1.202982
Loss Generator:   1.369101
Loss Generator:   1.441970
Generator    : Epoch:      2, update:     260, cost:   1.441970
Loss Generator:   1.479280
Loss Generator:   1.299677
Loss Generator:   1.419478
Loss Generator:   1.255410
Loss Generator:   1.117797
Loss Generator:   0.960891
Loss Generator:   1.193475
Loss Generator:   1.125241
Loss Generator:   1.264236
Loss Generator:   1.286573
Generator    : Epoch:      2, update:     270, cost:   1.286573
Loss Generator:   1.342490
Loss Generator:   1.112515
Discriminator: Epoch:      2, update:     272, cost:   0.297477
Loss Generator:   1.028426
Loss Generator:   1.421065
Loss Generator:   1.355230
Loss Generator:   1.158025
Loss Generator:   1.083467
Loss Generator:   1.247924
Loss Generator:   1.104553
Loss Generator:   1.124584
Generator    : Epoch:      2, update:     280, cost:   1.124584
Loss Generator:   1.070879
Loss Generator:   1.059522
Loss Generator:   1.447245
Loss Generator:   1.408486
Loss Generator:   1.155125
Loss Generator:   1.118227
Loss Generator:   1.086206
Loss Generator:   1.191688
Loss Generator:   1.179409
Loss Generator:   1.326910
Generator    : Epoch:      2, update:     290, cost:   1.326910
Loss Generator:   1.219785
Loss Generator:   1.196096
Loss Generator:   1.173225
Loss Generator:   1.049816
Loss Generator:   1.354411
Loss Generator:   1.355983
Loss Generator:   1.110332
Loss Generator:   1.325572
Loss Generator:   1.566318
Loss Generator:   1.192077
Generator    : Epoch:      2, update:     300, cost:   1.192077
Validation  3 - LOSS = 1.722 (PPL: 5.595)
Calling beam-search process
Beam-search ended, took 2.84386 minutes.
Validation  3 - BLEU = 4.90, 9.7/5.8/3.9/2.6 (BP=1.000, ratio=5.345, hyp_len=22554, ref_len=4220)
Early stopping patience: 998 validation left
--> Current BEST BLEU = 7.260 at validation 1
--> Current BEST LOSS = 1.675 (PPL: 5.339) at validation 2
--> This is model: attention_GAN-e512-i512-o512-r1024-adadelta_1e+00-bs80-bleu-each100_do_d0.0-gc1-init_xavier-s1234.7
Loss Generator:   1.350207
Loss Generator:   1.280515
Loss Generator:   1.053928
Loss Generator:   1.319370
Loss Generator:   1.206775
Loss Generator:   1.107687
Discriminator: Epoch:      2, update:     306, cost:   0.334835
Loss Generator:   1.217988
Loss Generator:   1.228542
Loss Generator:   1.239184
Loss Generator:   1.278497
Generator    : Epoch:      2, update:     310, cost:   1.278497
Loss Generator:   1.252306
Loss Generator:   1.493931
Loss Generator:   1.163123
Loss Generator:   1.186669
Loss Generator:   1.238185
Discriminator: Epoch:      2, update:     315, cost:   0.232030
Loss Generator:   1.247397
Loss Generator:   1.228293
Loss Generator:   1.232313
Loss Generator:   1.338583
Loss Generator:   1.357548
Discriminator: Epoch:      2, update:     320, cost:   0.355206
Generator    : Epoch:      2, update:     320, cost:   1.357548
Loss Generator:   1.043923
Loss Generator:   1.106412
Loss Generator:   1.386642
Loss Generator:   1.322365
Loss Generator:   1.181113
Loss Generator:   1.170626
Loss Generator:   1.215666
Loss Generator:   1.388014
Loss Generator:   0.940522
Loss Generator:   0.997712
Generator    : Epoch:      2, update:     330, cost:   0.997712
Loss Generator:   0.994569
Loss Generator:   1.146831
Loss Generator:   1.003509
Loss Generator:   0.915756
Loss Generator:   0.930043
Loss Generator:   0.933136
Loss Generator:   1.093618
Loss Generator:   1.188072
Loss Generator:   1.073848
Loss Generator:   1.229363
Generator    : Epoch:      2, update:     340, cost:   1.229363
Loss Generator:   1.023896
Loss Generator:   1.473658
Loss Generator:   1.036119
Loss Generator:   0.969224
Loss Generator:   1.097185
Loss Generator:   1.154960
Loss Generator:   1.025847
Loss Generator:   1.004429
Loss Generator:   1.093319
Loss Generator:   1.298600
Generator    : Epoch:      2, update:     350, cost:   1.298600
Loss Generator:   1.227051
Loss Generator:   1.252531
Loss Generator:   0.995195
Loss Generator:   1.075106
Loss Generator:   0.911781
Discriminator: Epoch:      2, update:     355, cost:   0.259956
Loss Generator:   1.242796
Loss Generator:   1.097764
Loss Generator:   1.018917
Loss Generator:   1.138920
Loss Generator:   1.022232
Generator    : Epoch:      2, update:     360, cost:   1.022232
Loss Generator:   1.258656
Loss Generator:   1.059448
Loss Generator:   1.042681
Loss Generator:   0.963543
Loss Generator:   1.257278
Loss Generator:   1.349554
Loss Generator:   0.897871
Loss Generator:   1.235559
Loss Generator:   1.081749
Loss Generator:   1.050113
Generator    : Epoch:      2, update:     370, cost:   1.050113
Loss Generator:   1.241233
Loss Generator:   1.173010
Loss Generator:   1.274888
Loss Generator:   1.259585
Loss Generator:   1.326986
Loss Generator:   1.151926
Loss Generator:   1.230490
Loss Generator:   1.324402
Loss Generator:   1.184178
Loss Generator:   1.262823
Generator    : Epoch:      2, update:     380, cost:   1.262823
Loss Generator:   1.065731
Loss Generator:   1.120337
Loss Generator:   1.042945
Loss Generator:   1.318928
Loss Generator:   1.245801
Loss Generator:   0.904944
Loss Generator:   1.135542
Loss Generator:   0.898208
Loss Generator:   1.227501
Loss Generator:   1.148308
Generator    : Epoch:      2, update:     390, cost:   1.148308
Loss Generator:   1.004894
Loss Generator:   1.128457
Loss Generator:   1.302332
Loss Generator:   1.225824
Loss Generator:   1.286793
Loss Generator:   1.426771
Loss Generator:   1.041782
Loss Generator:   0.981637
Loss Generator:   1.008676
Loss Generator:   0.981643
Generator    : Epoch:      2, update:     400, cost:   0.981643
Validation  4 - LOSS = 1.710 (PPL: 5.527)
Calling beam-search process
Beam-search ended, took 2.36516 minutes.
Validation  4 - BLEU = 6.54, 12.9/7.8/5.3/3.5 (BP=1.000, ratio=4.170, hyp_len=17597, ref_len=4220)
Early stopping patience: 997 validation left
--> Current BEST BLEU = 7.260 at validation 1
--> Current BEST LOSS = 1.675 (PPL: 5.339) at validation 2
--> This is model: attention_GAN-e512-i512-o512-r1024-adadelta_1e+00-bs80-bleu-each100_do_d0.0-gc1-init_xavier-s1234.7
Loss Generator:   1.293840
Loss Generator:   1.186633
Loss Generator:   1.095086
Loss Generator:   1.130043
Loss Generator:   1.266508
Loss Generator:   1.092171
Discriminator: Epoch:      2, update:     406, cost:   0.243490
Loss Generator:   1.124048
Loss Generator:   1.001670
Loss Generator:   0.875241
Loss Generator:   1.016581
Generator    : Epoch:      2, update:     410, cost:   1.016581
Loss Generator:   1.049721
Loss Generator:   1.346241
Loss Generator:   1.272967
Loss Generator:   1.435208
Loss Generator:   1.389839
Loss Generator:   1.421005
Loss Generator:   1.347750
Loss Generator:   1.143066
Loss Generator:   1.207472
Loss Generator:   1.252635
Generator    : Epoch:      2, update:     420, cost:   1.252635
Loss Generator:   1.003922
Discriminator: Epoch:      2, update:     421, cost:   0.349291
Loss Generator:   1.016492
Discriminator: Epoch:      2, update:     422, cost:   0.306367
Loss Generator:   1.123758
Loss Generator:   0.998885
Loss Generator:   1.046492
Loss Generator:   1.079170
Loss Generator:   1.405178
Loss Generator:   1.474601
Loss Generator:   1.388045
Loss Generator:   1.007069
Generator    : Epoch:      2, update:     430, cost:   1.007069
Loss Generator:   1.110761
Loss Generator:   1.287612
Loss Generator:   1.173453
Loss Generator:   1.264655
Loss Generator:   1.296427
Loss Generator:   1.239293
Loss Generator:   1.232715
Loss Generator:   1.422009
Loss Generator:   1.329772
Loss Generator:   1.247002
Generator    : Epoch:      2, update:     440, cost:   1.247002
Loss Generator:   1.372481
Loss Generator:   1.150688
Loss Generator:   1.507406
Loss Generator:   1.490374
Loss Generator:   0.949539
Loss Generator:   1.262661
Loss Generator:   1.182524
Loss Generator:   1.181195
Loss Generator:   1.310170
Loss Generator:   1.126282
Generator    : Epoch:      2, update:     450, cost:   1.126282
Loss Generator:   1.103958
Loss Generator:   1.129758
Loss Generator:   1.086762
Loss Generator:   1.086421
Loss Generator:   0.979263
Loss Generator:   1.015860
Loss Generator:   1.202236
Loss Generator:   1.252641
Discriminator: Epoch:      2, update:     458, cost:   0.329677
Loss Generator:   1.242753
Discriminator: Epoch:      2, update:     459, cost:   0.317764
Loss Generator:   1.170387
Discriminator: Epoch:      2, update:     460, cost:   0.246921
Generator    : Epoch:      2, update:     460, cost:   1.170387
Loss Generator:   1.195956
Loss Generator:   1.286658
Discriminator: Epoch:      2, update:     462, cost:   0.384094
Loss Generator:   1.317495
Loss Generator:   1.031685
Discriminator: Epoch:      2, update:     464, cost:   0.252950
Loss Generator:   1.290663
Loss Generator:   1.205792
Loss Generator:   1.217943
Loss Generator:   1.153525
Discriminator: Epoch:      2, update:     468, cost:   0.359137
Loss Generator:   1.147222
Discriminator: Epoch:      2, update:     469, cost:   0.244425
Loss Generator:   1.177054
Generator    : Epoch:      2, update:     470, cost:   1.177054
Loss Generator:   1.100870
Loss Generator:   1.234102
Loss Generator:   1.223519
Loss Generator:   1.115269
Discriminator: Epoch:      2, update:     474, cost:   0.287048
Loss Generator:   1.153023
Loss Generator:   1.125707
Loss Generator:   1.136674
Loss Generator:   1.040694
Loss Generator:   1.082234
Loss Generator:   1.209994
Generator    : Epoch:      2, update:     480, cost:   1.209994
Loss Generator:   1.308284
Loss Generator:   1.233871
Loss Generator:   1.238535
Loss Generator:   0.894730
Loss Generator:   1.023733
Loss Generator:   1.092269
Loss Generator:   0.969561
Loss Generator:   1.189508
Loss Generator:   1.164337
Loss Generator:   1.109629
Generator    : Epoch:      2, update:     490, cost:   1.109629
Loss Generator:   1.097471
Loss Generator:   1.043050
Loss Generator:   0.995781
Loss Generator:   1.038634
Loss Generator:   1.206244
Loss Generator:   1.034138
Loss Generator:   1.084951
Loss Generator:   1.072722
Loss Generator:   1.148018
Loss Generator:   0.878066
Generator    : Epoch:      2, update:     500, cost:   0.878066
Validation  5 - LOSS = 1.646 (PPL: 5.188)
Calling beam-search process
Beam-search ended, took 2.92679 minutes.
Validation  5 - BLEU = 4.25, 8.5/5.2/3.4/2.2 (BP=1.000, ratio=5.497, hyp_len=23196, ref_len=4220)
Early stopping patience: 996 validation left
--> Current BEST BLEU = 7.260 at validation 1
--> Current BEST LOSS = 1.646 (PPL: 5.188) at validation 5
--> This is model: attention_GAN-e512-i512-o512-r1024-adadelta_1e+00-bs80-bleu-each100_do_d0.0-gc1-init_xavier-s1234.7
---------------------------------------------------------
Epoch summary of Generator    :
--> Epoch 2 finished with mean loss 1.17859 (PPL: 3.24979)
--> Epoch took 20927.362 minutes, 5022.567 sec/update
Epoch summary of Discriminator:
--> Epoch 2 finished with mean loss 0.29731 (PPL: 1.34624)
--> Epoch took 20927.362 minutes, 5022.567 sec/update
---------------------------------------------------------
Starting Epoch 3
----------------
Loss Generator:   1.354751
Loss Generator:   1.205321
Loss Generator:   1.162744
Loss Generator:   1.230672
Loss Generator:   1.130637
Loss Generator:   1.084830
Loss Generator:   1.205621
Loss Generator:   1.075335
Loss Generator:   1.263077
Loss Generator:   1.366354
Generator    : Epoch:      3, update:     510, cost:   1.366354
Loss Generator:   1.336797
Loss Generator:   1.238819
Loss Generator:   1.351850
Loss Generator:   1.224054
